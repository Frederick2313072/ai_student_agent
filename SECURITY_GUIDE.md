# 🔒 安全配置指南

## ⚠️ 重要安全提醒

**你的API密钥已经暴露在Git历史中！** 为了安全起见，建议立即采取以下行动：

### 🚨 立即行动

1. **更换所有API密钥**：
   - 登录OpenAI控制台，撤销旧密钥并生成新密钥
   - 如果使用了智谱AI，也请更换相关密钥
   - 更新其他服务的API密钥（Tavily、SerpApi等）

2. **检查API使用情况**：
   - 查看API使用日志，确认是否有异常调用
   - 监控账单，确保没有未授权使用

## 📁 环境配置

### 正确的配置方式

1. **复制模板文件**：
   ```bash
   cp environments/test.env.template environments/test.env
   ```

2. **编辑配置文件**：
   ```bash
   nano environments/test.env
   ```

3. **填入真实的API密钥**：
   - 只在本地的 `test.env` 文件中填入真实密钥
   - 不要提交包含真实密钥的文件到Git

### Vercel部署配置

在Vercel控制台设置环境变量：

| 变量名 | 说明 | 示例值 |
|--------|------|--------|
| `OPENAI_API_KEY` | OpenAI API密钥 | `sk-...` |
| `ENVIRONMENT` | 环境标识 | `production` |
| `DEBUG` | 调试模式 | `false` |

## 🛡️ 安全最佳实践

### 1. 环境变量管理
- ✅ 使用 `.env.template` 作为配置模板
- ✅ 在 `.gitignore` 中忽略包含敏感信息的文件
- ✅ 在部署平台（Vercel）中设置环境变量
- ❌ 不要将真实API密钥提交到Git

### 2. API密钥安全
- ✅ 定期轮换API密钥
- ✅ 为不同环境使用不同的密钥
- ✅ 设置API密钥的使用限制和监控
- ❌ 不要在代码中硬编码密钥

### 3. 访问控制
- ✅ 使用CORS限制API访问来源
- ✅ 实施速率限制
- ✅ 记录和监控API使用情况
- ❌ 不要将API暴露给不必要的来源

## 🔧 修复步骤

### 已完成的修复
- ✅ 更新了 `.gitignore` 以防止敏感文件被提交
- ✅ 从Git缓存中移除了包含密钥的文件
- ✅ 创建了安全的配置模板
- ✅ 提供了Vercel部署的安全配置方案

### 你需要做的
1. **更换API密钥**（重要！）
2. **在Vercel控制台设置新的环境变量**
3. **重新部署应用**

## 📞 如果遇到问题

如果你发现API密钥被滥用：
1. 立即撤销相关密钥
2. 检查账单和使用日志
3. 联系相关服务提供商报告安全问题
4. 考虑启用额外的安全措施（如IP白名单）

---

**记住：安全是第一位的！** 🔒
