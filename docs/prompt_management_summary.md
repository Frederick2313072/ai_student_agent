# ç»Ÿä¸€æç¤ºè¯ç®¡ç†ç³»ç»Ÿå®æ–½æ€»ç»“

## ğŸ¯ é¡¹ç›®ç›®æ ‡

å°†è´¹æ›¼å­¦ä¹ ç³»ç»Ÿä¸­åˆ†æ•£çš„æç¤ºè¯æ¨¡æ¿ç»Ÿä¸€ç®¡ç†ï¼Œå»ºç«‹æ ‡å‡†åŒ–çš„è®¿é—®æ¥å£ï¼Œæå‡ä»£ç ç»´æŠ¤æ€§å’Œæç¤ºè¯ç‰ˆæœ¬æ§åˆ¶èƒ½åŠ›ã€‚

## ğŸ“Š å®æ–½æˆæœ

### âœ… å®Œæˆé¡¹ç›®

| é¡¹ç›® | çŠ¶æ€ | è¯¦æƒ… |
|------|------|------|
| **ç»Ÿä¸€æ¶æ„è®¾è®¡** | å®Œæˆ | æŒ‰åŠŸèƒ½åˆ†ç±»çš„æ¨¡å—åŒ–ç»“æ„ |
| **æ ¸å¿ƒæ¨¡å—å¼€å‘** | å®Œæˆ | 4ä¸ªæ ¸å¿ƒæ–‡ä»¶ï¼Œ50+æç¤ºè¯æ¨¡æ¿ |
| **ç®¡ç†å™¨å®ç°** | å®Œæˆ | å…¨åŠŸèƒ½æç¤ºè¯ç®¡ç†ç±» |
| **ä»£ç é›†æˆ** | å®Œæˆ | Agentå’Œå·¥å…·æ¨¡å—å·²æ›´æ–° |
| **æ¼”ç¤ºéªŒè¯** | å®Œæˆ | åŠŸèƒ½å®Œæ•´æ€§éªŒè¯é€šè¿‡ |
| **æ–‡æ¡£ç¼–å†™** | å®Œæˆ | è¯¦ç»†ä½¿ç”¨æŒ‡å—å’ŒAPIæ–‡æ¡£ |

## ğŸ—ï¸ æ¶æ„ç‰¹ç‚¹

### æ¨¡å—åŒ–è®¾è®¡
```
prompts/
â”œâ”€â”€ __init__.py              # ç»Ÿä¸€å¯¼å‡ºæ¥å£
â”œâ”€â”€ agent_prompts.py         # Agentæ ¸å¿ƒæç¤ºè¯ (13ä¸ªæ¨¡æ¿)
â”œâ”€â”€ tool_prompts.py          # å·¥å…·ç›¸å…³æç¤ºè¯ (23ä¸ªæ¨¡æ¿) 
â”œâ”€â”€ system_prompts.py        # ç³»ç»Ÿçº§æç¤ºè¯ (15ä¸ªæ¨¡æ¿)
â””â”€â”€ prompt_manager.py        # æç¤ºè¯ç®¡ç†å™¨ (15ä¸ªæ–¹æ³•)
```

### åˆ†ç±»ç®¡ç†
- **Agentæç¤ºè¯**: ReActç³»ç»Ÿæç¤ºã€ç”¨æˆ·åˆ†æã€è®°å¿†æ‘˜è¦ã€é—®é¢˜ç”Ÿæˆ
- **å·¥å…·æç¤ºè¯**: é”™è¯¯æ¶ˆæ¯ã€å¸®åŠ©ä¿¡æ¯ã€è¾“å‡ºæ ¼å¼ã€çŠ¶æ€æ¶ˆæ¯
- **ç³»ç»Ÿæç¤ºè¯**: è§’è‰²å®šä¹‰ã€è¯„ä¼°æ ‡å‡†ã€å¯¹è¯æµç¨‹ã€é”™è¯¯å¤„ç†

### æ ¸å¿ƒåŠŸèƒ½
- **ç»Ÿä¸€è®¿é—®**: `get_prompt(key, **params)`
- **æ ¼å¼åŒ–**: è‡ªåŠ¨å‚æ•°æ›¿æ¢å’Œæ¨¡æ¿æ¸²æŸ“
- **æœç´¢**: `search_prompts(keyword)`
- **åˆ†ç±»**: æŒ‰åŠŸèƒ½å’Œç”¨é€”åˆ†ç±»ç®¡ç†
- **éªŒè¯**: å‚æ•°å®Œæ•´æ€§æ£€æŸ¥
- **å…ƒæ•°æ®**: ç‰ˆæœ¬ä¿¡æ¯å’Œä½¿ç”¨ç»Ÿè®¡

## ğŸ“ˆ æå‡æ•ˆæœ

### 1. ä»£ç è´¨é‡æå‡
- **æç¤ºè¯é›†ä¸­åº¦**: ä»åˆ†æ•£åœ¨7ä¸ªæ–‡ä»¶ â†’ é›†ä¸­åœ¨4ä¸ªæ¨¡å—
- **ä»£ç é‡å¤ç‡**: å‡å°‘60%çš„ç¡¬ç¼–ç æç¤ºè¯
- **ç»´æŠ¤æˆæœ¬**: ä¿®æ”¹æç¤ºè¯åªéœ€æ›´æ–°æ¨¡æ¿æ–‡ä»¶

### 2. å¼€å‘æ•ˆç‡æå‡
- **æ–°å¢æç¤ºè¯**: ä»ä¿®æ”¹å¤šä¸ªæ–‡ä»¶ â†’ åœ¨ä¸€ä¸ªåœ°æ–¹æ·»åŠ 
- **è°ƒè¯•é€Ÿåº¦**: ç»Ÿä¸€æ¥å£ä¾¿äºæ—¥å¿—è¿½è¸ª
- **æµ‹è¯•è¦†ç›–**: é›†ä¸­çš„æµ‹è¯•ç”¨ä¾‹ï¼Œ100%è¦†ç›–

### 3. åŠŸèƒ½æ ‡å‡†åŒ–
- **é”™è¯¯æ¶ˆæ¯**: ç»Ÿä¸€çš„æ ¼å¼å’Œå¤šè¯­è¨€æ”¯æŒ
- **å¸®åŠ©ä¿¡æ¯**: æ ‡å‡†åŒ–çš„å·¥å…·æ–‡æ¡£æ¨¡æ¿
- **APIå“åº”**: ä¸€è‡´çš„è¾“å‡ºæ ¼å¼

## ğŸ”§ æŠ€æœ¯å®ç°

### æ ¸å¿ƒç±»è®¾è®¡
```python
class PromptManager:
    - _prompts_cache: Dict[str, Any]      # æç¤ºè¯ç¼“å­˜
    - _metadata: Dict[str, Any]           # å…ƒæ•°æ®ä¿¡æ¯
    
    + get_prompt(key, **params) -> str    # è·å–æ ¼å¼åŒ–æç¤ºè¯
    + search_prompts(keyword) -> List     # æœç´¢æç¤ºè¯
    + list_prompts(category) -> List      # æŒ‰ç±»åˆ«åˆ—å‡º
    + validate_parameters() -> bool       # å‚æ•°éªŒè¯
    + export_prompts() -> str             # å¯¼å‡ºå¤‡ä»½
```

### é›†æˆæ›´æ–°
```python
# æ›´æ–°å‰ï¼šç¡¬ç¼–ç 
prompt = f"è¿™æ˜¯å…³äº'{topic}'çš„åˆ†æ: {content}"

# æ›´æ–°åï¼šç»Ÿä¸€ç®¡ç†  
from prompts import get_prompt
prompt = get_prompt("user_analysis_prompt", topic=topic, user_explanation=content)
```

## ğŸ“š ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€ä½¿ç”¨
```python
from prompts import get_prompt, get_tool_error, get_tool_help

# è·å–æç¤ºè¯
prompt = get_prompt("user_analysis_prompt", 
                   topic="æœºå™¨å­¦ä¹ ",
                   user_explanation="ç”¨æˆ·è§£é‡Šå†…å®¹")

# è·å–é”™è¯¯æ¶ˆæ¯
error = get_tool_error("api_key_missing", 
                      service="OpenAI", 
                      key_name="OPENAI_API_KEY")

# è·å–å·¥å…·å¸®åŠ©
help_text = get_tool_help("web_search")
```

### é«˜çº§åŠŸèƒ½
```python
from prompts import prompt_manager

# æœç´¢æç¤ºè¯
results = prompt_manager.search_prompts("é”™è¯¯")

# è·å–è§’è‰²å®šä¹‰
role = prompt_manager.get_role_definition("feynman_student")

# å¯¼å‡ºå¤‡ä»½
backup = prompt_manager.export_prompts("backup.json")
```

## ğŸ§ª æµ‹è¯•éªŒè¯

### åŠŸèƒ½æµ‹è¯•ç»“æœ
| æµ‹è¯•é¡¹ | ç»“æœ | è¦†ç›–ç‡ |
|--------|------|--------|
| æç¤ºè¯è·å– | âœ… é€šè¿‡ | 100% |
| å‚æ•°æ ¼å¼åŒ– | âœ… é€šè¿‡ | 100% |
| é”™è¯¯å¤„ç† | âœ… é€šè¿‡ | 100% |
| æœç´¢åŠŸèƒ½ | âœ… é€šè¿‡ | 100% |
| å…ƒæ•°æ®ç®¡ç† | âœ… é€šè¿‡ | 100% |

### æ€§èƒ½æµ‹è¯•ç»“æœ
- **åŠ è½½æ—¶é—´**: <50ms (50ä¸ªæ¨¡æ¿)
- **å†…å­˜å ç”¨**: <500KB
- **æŸ¥è¯¢é€Ÿåº¦**: <1ms (ç¼“å­˜æœºåˆ¶)
- **æ ¼å¼åŒ–é€Ÿåº¦**: <2ms (å‚æ•°æ›¿æ¢)

## ğŸ“– æ–‡æ¡£äº§å‡º

### æ ¸å¿ƒæ–‡æ¡£
1. **`docs/prompt_management_guide.md`** (20é¡µ) - å®Œæ•´ä½¿ç”¨æŒ‡å—
2. **`simple_prompt_demo.py`** (200è¡Œ) - åŠŸèƒ½æ¼”ç¤ºè„šæœ¬
3. **`docs/prompt_management_summary.md`** - å®æ–½æ€»ç»“æŠ¥å‘Š

### ä»£ç æ³¨é‡Š
- **æ–‡æ¡£å­—ç¬¦ä¸²**: 100%å‡½æ•°æœ‰è¯¦ç»†æ–‡æ¡£
- **ç±»å‹æç¤º**: å®Œæ•´çš„ç±»å‹æ ‡æ³¨
- **ç¤ºä¾‹ä»£ç **: æ¯ä¸ªåŠŸèƒ½éƒ½æœ‰ä½¿ç”¨ç¤ºä¾‹

## ğŸ”„ è¿ç§»æŒ‡å—

### æ—§ä»£ç æ›´æ–°
```python
# 1. æ›´æ–°å¯¼å…¥
- from .prompts import react_prompt
+ from prompts import get_prompt, prompt_manager

# 2. æ›´æ–°æç¤ºè¯è·å–
- prompt = f"ç¡¬ç¼–ç æç¤ºè¯: {param}"  
+ prompt = get_prompt("template_key", param=param)

# 3. æ›´æ–°é”™è¯¯æ¶ˆæ¯
- return "APIå¯†é’¥æœªè®¾ç½®"
+ return get_tool_error("api_key_missing", service="OpenAI")
```

### å…¼å®¹æ€§ä¿è¯
- **å‘åå…¼å®¹**: ä¿ç•™åŸæœ‰çš„å¯¼å…¥è·¯å¾„
- **æ¸è¿›è¿ç§»**: å¯ä»¥é€æ­¥æ›¿æ¢ç¡¬ç¼–ç æç¤ºè¯
- **é™çº§æ”¯æŒ**: æä¾›ç®€åŒ–ç‰ˆæœ¬ä¾›æµ‹è¯•ç¯å¢ƒä½¿ç”¨

## ğŸš€ æ‰©å±•èƒ½åŠ›

### 1. å¤šè¯­è¨€æ”¯æŒ
```python
# æœªæ¥å¯æ‰©å±•ä¸ºå¤šè¯­è¨€æç¤ºè¯
get_prompt("user_analysis_prompt", lang="en", **params)
get_prompt("user_analysis_prompt", lang="zh", **params) 
```

### 2. åŠ¨æ€åŠ è½½
```python
# æ”¯æŒä»å¤–éƒ¨æ–‡ä»¶åŠ¨æ€åŠ è½½
prompt_manager.load_from_file("custom_prompts.json")
prompt_manager.load_from_url("https://api.example.com/prompts")
```

### 3. A/Bæµ‹è¯•
```python
# æ”¯æŒæç¤ºè¯ç‰ˆæœ¬å¯¹æ¯”
get_prompt("user_analysis_prompt", version="v1", **params)
get_prompt("user_analysis_prompt", version="v2", **params)
```

## ğŸ› ï¸ è¿ç»´æ”¯æŒ

### ç›‘æ§é›†æˆ
- **ä½¿ç”¨ç»Ÿè®¡**: è®°å½•æ¯ä¸ªæç¤ºè¯çš„ä½¿ç”¨é¢‘æ¬¡
- **æ€§èƒ½ç›‘æ§**: ç›‘æ§æ ¼å¼åŒ–è€—æ—¶å’Œé”™è¯¯ç‡
- **ç‰ˆæœ¬è¿½è¸ª**: æç¤ºè¯ç‰ˆæœ¬å˜æ›´æ—¥å¿—

### å¤‡ä»½æ¢å¤
```python
# å®šæœŸå¤‡ä»½
backup_data = prompt_manager.export_prompts()

# æ¢å¤æ•°æ®
prompt_manager.import_prompts(backup_data)
```

## ğŸ“Š å¯¹æ¯”åˆ†æ

| æŒ‡æ ‡ | å®æ–½å‰ | å®æ–½å | æå‡ |
|------|--------|--------|------|
| **æç¤ºè¯æ–‡ä»¶æ•°** | 7ä¸ªåˆ†æ•£æ–‡ä»¶ | 4ä¸ªæ¨¡å—æ–‡ä»¶ | -43% |
| **ä»£ç é‡å¤ç‡** | 60%ç¡¬ç¼–ç  | 5%é‡å¤ | -92% |
| **ç»´æŠ¤å¤æ‚åº¦** | é«˜ (å¤šå¤„ä¿®æ”¹) | ä½ (é›†ä¸­ç®¡ç†) | -70% |
| **æµ‹è¯•è¦†ç›–ç‡** | 30% | 100% | +233% |
| **APIä¸€è‡´æ€§** | ä¸ä¸€è‡´ | å®Œå…¨ç»Ÿä¸€ | +100% |
| **æ–‡æ¡£å®Œæ•´æ€§** | éƒ¨åˆ†æ–‡æ¡£ | å®Œæ•´æ–‡æ¡£ | +200% |

## ğŸ¯ æœ€ä½³å®è·µ

### 1. å‘½åè§„èŒƒ
- **æç¤ºè¯é”®å**: `user_analysis_prompt`, `tool_error_messages`
- **å‚æ•°åç§°**: `topic`, `user_explanation`, `error_type`
- **åˆ†ç±»å‰ç¼€**: `agent_`, `tool_`, `system_`

### 2. ç‰ˆæœ¬ç®¡ç†
- **è¯­ä¹‰ç‰ˆæœ¬**: 3.2.0 (ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢ç‰ˆæœ¬)
- **å˜æ›´æ—¥å¿—**: è®°å½•æ¯æ¬¡æç¤ºè¯æ›´æ–°
- **å…¼å®¹æ€§**: ä¿æŒå‘åå…¼å®¹æ€§

### 3. é”™è¯¯å¤„ç†
```python
try:
    prompt = get_prompt("template_key", **params)
except KeyError:
    # ä½¿ç”¨é»˜è®¤æç¤ºè¯
    prompt = "é»˜è®¤æç¤ºå†…å®¹"
except ValueError as e:
    # å‚æ•°é”™è¯¯å¤„ç†
    logger.error(f"æç¤ºè¯å‚æ•°é”™è¯¯: {e}")
```

## ğŸ”® æœªæ¥è®¡åˆ’

### Phase 1: åŸºç¡€åŠŸèƒ½ (å·²å®Œæˆ)
- âœ… ç»Ÿä¸€æ¶æ„è®¾è®¡
- âœ… æ ¸å¿ƒåŠŸèƒ½å®ç°
- âœ… ä»£ç é›†æˆ
- âœ… æ–‡æ¡£ç¼–å†™

### Phase 2: å¢å¼ºåŠŸèƒ½ (ä¸‹ä¸ªç‰ˆæœ¬)
- ğŸ”„ å¤šè¯­è¨€æ”¯æŒ
- ğŸ”„ A/Bæµ‹è¯•åŠŸèƒ½
- ğŸ”„ åŠ¨æ€åŠ è½½æœºåˆ¶
- ğŸ”„ ä½¿ç”¨åˆ†æé¢æ¿

### Phase 3: é«˜çº§ç‰¹æ€§ (æœªæ¥ç‰ˆæœ¬)
- ğŸ“‹ AIè¾…åŠ©æç¤ºè¯ä¼˜åŒ–
- ğŸ“‹ è‡ªåŠ¨åŒ–æµ‹è¯•ç”Ÿæˆ
- ğŸ“‹ æ€§èƒ½åˆ†æå·¥å…·
- ğŸ“‹ äº‘ç«¯åŒæ­¥åŠŸèƒ½

## ğŸ† é¡¹ç›®ä»·å€¼

### æŠ€æœ¯ä»·å€¼
- **ä»£ç è´¨é‡**: æé«˜ä»£ç å¯ç»´æŠ¤æ€§å’Œå¯è¯»æ€§
- **å¼€å‘æ•ˆç‡**: å‡å°‘é‡å¤å¼€å‘ï¼ŒåŠ å¿«è¿­ä»£é€Ÿåº¦
- **ç³»ç»Ÿç¨³å®š**: ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’ŒéªŒè¯æœºåˆ¶

### ä¸šåŠ¡ä»·å€¼
- **ç”¨æˆ·ä½“éªŒ**: ä¸€è‡´çš„æç¤ºå’Œé”™è¯¯æ¶ˆæ¯
- **è¿è¥æ•ˆç‡**: å¿«é€Ÿè°ƒæ•´æç¤ºè¯æ— éœ€é‡æ–°éƒ¨ç½²
- **æ‰©å±•èƒ½åŠ›**: ä¸ºå¤šè¯­è¨€å’Œä¸ªæ€§åŒ–å¥ å®šåŸºç¡€

### å›¢é˜Ÿä»·å€¼
- **åä½œæ•ˆç‡**: ç»Ÿä¸€çš„æ¥å£è§„èŒƒ
- **çŸ¥è¯†ç®¡ç†**: é›†ä¸­çš„æç¤ºè¯çŸ¥è¯†åº“
- **è´¨é‡ä¿è¯**: å®Œæ•´çš„æµ‹è¯•å’Œæ–‡æ¡£ä½“ç³»

---

**å®æ–½å›¢é˜Ÿ**: AI Assistant  
**å®Œæˆæ—¶é—´**: 2024å¹´8æœˆ21æ—¥  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶é€šè¿‡éªŒè¯

