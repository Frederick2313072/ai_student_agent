# 技术选型文档：AI 学生代理

本文档旨在为 “AI 学生代理” 项目的前端和 Chrome 插件部分进行技术选型，目标是选择一套现代化、高效且能够与项目 Python 后端（FastAPI, LangChain）紧密结合的开发技术栈。

## 1. 核心思想

项目旨在创建一个允许用户通过浏览器侧边栏与 AI 互动、对当前网页内容进行提问的工具。技术选型将围绕以下几点展开：

- **现代化的开发体验**: 选用社区活跃、工具链成熟、开发效率高的技术。
- **AI 优先**: 组件库和工具应为构建 AI 聊天界面而设计，简化开发流程。
- **React 生态**: 基于用户已确定的 React 框架进行技术栈扩展。
- **结构清晰**: 前端应用和 Chrome 插件的代码结构应清晰分离，易于维护。
- **高效对接**: 充分利用 FastAPI 的特性，实现前后端的高效协作。

## 2. 技术栈详情

### 2.1. 后端集成策略

- **API 接口**: 后端采用的 **FastAPI** 框架会自动生成符合 **OpenAPI 规范**的交互式 API 文档 (Swagger UI)。这将作为前后端通信的统一标准，前端可以直接根据此文档进行数据请求和模型对接，极大提高开发效率。
- **数据通信**: 前后端将通过标准的 RESTful API 进行通信，使用 JSON 格式传输数据。对于 AI 的流式响应，我们将通过 FastAPI 设置流式接口，前端使用 `Fetch API` 或 `XRequest` 进行接收和处理。

### 2.2. 整体项目结构

为了保持代码的组织性和分离性，我们将在项目根目录创建两个新的文件夹：

- `frontend/`: 存放独立的 Web 前端应用代码。
- `chrome-extension/`: 存放 Chrome 插件相关的所有代码。

现有的 Python 后端代码将作为项目的 API 服务端。

```
/
├── agent/
├── core/
├── data/
├── docs/
│   └── technology_selection.md
├── frontend/ (新)
├── chrome-extension/ (新)
├── ... (其他现有文件和目录)
└── main.py
```

### 2.3. 前端应用 (`frontend/`)

| 类别               | 技术/工具                                      | 理由与说明                                                                                                                                                              |
| :----------------- | :--------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **构建工具**       | **Vite**                                       | 提供极速的冷启动和热更新 (HMR)，基于 esbuild，构建速度远超 Webpack，带来极致的开发体验。                                                                                |
| **核心框架**       | **React**                                      | 根据用户要求，作为项目的基础框架。                                                                                                                                      |
| **开发语言**       | **TypeScript**                                 | 为项目提供静态类型检查，增强代码健壮性、可读性和可维护性，是现代中大型项目的标配。                                                                                      |
| **UI & AI 组件库** | **Ant Design X (`@ant-design/x`)**             | **最终选择**。经过与 Vercel AI SDK, Assistant-UI 等库对比，Ant Design X 在提供丰富 UI 组件的同时，内置了强大的对话状态管理 (`useXChat`)，是最适合本项目的“全家桶”方案。 |
| **状态管理**       | **Ant Design X 内置方案** + **Zustand** (备选) | 优先使用 Ant Design X 自带的状态管理方案 (`useXChat`)。若未来出现复杂的非对话类的全局状态需求，Zustand 是一个轻量、简洁且强大的选择。                                   |
| **路由**           | **React Router**                               | React 社区最主流的路由管理库，功能强大稳定。                                                                                                                            |
| **数据请求**       | **Fetch API** / **XRequest**                   | 优先使用 Ant Design X 提供的 `XRequest` 工具与 AI 后端交互。它能更好地处理流式数据。对于其他普通 API 请求，可使用浏览器原生的 `Fetch API`。                             |

### 2.4. Chrome 插件 (`chrome-extension/`)

Chrome 插件将负责将侧边栏注入到用户浏览的网页中。

| 类别           | 技术/工具                                          | 理由与说明                                                                                                                                |
| :------------- | :------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------- |
| **清单版本**   | **Manifest V3**                                    | Chrome 插件的最新标准，提供更好的安全性、性能和隐私保护。                                                                                 |
| **核心结构**   | **Content Script, Background Service Worker**      | **Content Script**: 用于向页面注入 UI 和操作 DOM。<br/>**Background Script**: 作为 Service Worker 运行，处理后台事件和与后端 API 的通信。 |
| **侧边栏 UI**  | **React + Ant Design X**                           | 侧边栏本身将是一个独立的 React 应用，使用与主前端应用相同的技术栈，以复用组件和逻辑，统一开发体验。                                       |
| **构建与打包** | **Vite** + **`@samrum/vite-plugin-web-extension`** | **最终选择**。此 Vite 插件对 Manifest V3 支持良好，维护活跃，并提供官方脚手架，可快速生成项目模板，是当前最优选择。                       |

## 3. 下一步计划

1.  **环境搭建**: 根据选型，使用 Vite 初始化 `frontend` 和 `chrome-extension` 的 React + TypeScript 项目模板。
2.  **原型开发**:
    - 在 `frontend` 目录中，使用 Ant Design X 组件快速搭建一个独立的聊天页面作为功能原型。
    - 在 `chrome-extension` 目录中，实现基础的侧边栏注入功能。
3.  **API 对接**: 与 Python 后端定义 API 接口规范，并使用 `XRequest` 或 Fetch 进行前后端联调。

---
